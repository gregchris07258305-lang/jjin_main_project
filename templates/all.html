<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì „ì²´ ì •ì±… ë³´ê¸° | ì“±ì“±</title>
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css">
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-orange': '#F48245',
                        'primary-teal': '#4A9EA8',
                        'primary-beige': '#D9B36C'
                    },
                    fontFamily: { sans: ['Pretendard', 'sans-serif'] },
                    screens: {
                        'xs': '500px'
                    },
                    boxShadow: {
                        'floating': '0 20px 40px -5px rgba(0, 0, 0, 0.15), 0 10px 20px -5px rgba(0, 0, 0, 0.1)',
                    }
                }
            }
        }
    </script>
    <style>
        .perspective-wrap {
            perspective: 1000px;
            /* ìì‹ë“¤ì—ê²Œ 3D ê³µê°„ ì œê³µ */
        }

        /* ê°€ë¡œ ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¸°ê¸° (í¬ë¡¬, ì‚¬íŒŒë¦¬, ì˜¤í˜ë¼) */
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }

        /* ê°€ë¡œ ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¸°ê¸° (IE, ì—£ì§€, íŒŒì´ì–´í­ìŠ¤) */
        .hide-scrollbar {
            -ms-overflow-style: none;
            /* IE and Edge */
            scrollbar-width: none;
            /* Firefox */
        }

        /* [NEW] ì˜¤ì§ 'ë– ì˜¤ë¥´ëŠ”' ì—­í• ë§Œ í•˜ëŠ” ì¤‘ê°„ ê´€ë¦¬ì */
        .card-lifter {
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            will-change: transform;
            /* ë¶€ë“œëŸ¬ìš´ ì›€ì§ì„ ë³´ì¥ */
        }

        .policy-card {
            transform-style: preserve-3d;
            /* í…ìŠ¤íŠ¸ ì„ ëª…ë„ë¥¼ ìœ„í•œ ì„¤ì • */
            backface-visibility: hidden;
            -webkit-font-smoothing: antialiased;
            /* íšŒì „ ì‹œ ê³„ë‹¨ í˜„ìƒ ë°©ì§€ */
            transform: translateZ(0);
            width: 100%;
            height: 100%;
        }

        /* [ìˆ˜ì •] í…ìŠ¤íŠ¸(.card-content)ì˜ 3D ì†ì„±ì„ ì œê±°í•˜ì—¬ ì„ ëª…ë„ í™•ë³´ */
        .card-content {
            transform: translateZ(1px);
            /* ì¹´ë“œ ë©´ë³´ë‹¤ ì•„ì£¼ ì‚´ì§ ìœ„ (ê¸€ì ê¹¨ì§ ë°©ì§€) */
            background-color: #fff;
        }

        /* ì´ë¯¸ì§€ëŠ” 3D íš¨ê³¼ ìœ ì§€ (ì…ì²´ê°) */
        .card-image {
            transform-style: preserve-3d;
            transform: translateZ(20px);
            /* ì´ë¯¸ì§€ëŠ” ë” íŠ€ì–´ë‚˜ì˜¤ê²Œ */
        }
    </style>
</head>

<body class="bg-gray-50 font-sans">
    <nav style="z-index: 99999; position: sticky; top: 0;"
        class="w-full border-b border-gray-100 bg-white/70 backdrop-blur-md transition-all duration-300">
        <div class="mx-auto flex h-[80px] max-w-[1200px] items-center justify-center md:justify-between px-5">
            <a href="/" class="hidden md:flex items-center transition-opacity hover:opacity-80">
                <img src="/static/images/team_logo.webp"
                    onerror="this.src='https://placehold.co/100x40/transparent/333?text=LOGO'" alt="Logo"
                    class="h-10 w-auto">
            </a>
            <ul class="hidden xs:flex gap-2 md:gap-3">
                <button id="hamburger-btn"
                    class="xs:hidden absolute right-5 top-1/2 -translate-y-1/2 text-gray-700 hover:text-primary-teal transition-colors p-2">
                    <i class="fa-solid fa-bars text-2xl"></i>
                </button>

                <div id="mobile-menu"
                    class="hidden absolute top-[80px] left-0 w-full bg-white border-b border-gray-100 shadow-lg p-5 flex flex-col gap-3 z-50">
                    <a href="/main.html"
                        class="block w-full text-center py-3 rounded-lg font-bold text-gray-600 hover:bg-gray-50">Home</a>
                    <a href="/all.html"
                        class="block w-full text-center py-3 rounded-lg font-bold text-primary-teal bg-teal-50">All
                        Policies</a>
                    <a href="/mypage.html"
                        class="block w-full text-center py-3 rounded-lg font-bold text-gray-600 hover:bg-gray-50">My
                        Page</a>
                    <a href="/about.html"
                        class="block w-full text-center py-3 rounded-lg font-bold text-gray-600 hover:bg-gray-50">About</a>
                </div>
                <li><a href="/main.html"
                        class="flex items-center justify-center rounded-full px-4 py-2 text-[14px] md:text-[15px] font-bold text-gray-600 bg-gray-100 hover:bg-gray-200 transition-all">Home</a>
                </li>
                <li><a href="/all.html"
                        class="flex items-center justify-center rounded-full px-4 py-2 text-[14px] md:text-[15px] font-bold text-white bg-primary-teal shadow-md transition-all">All
                        Policies</a></li>
                <li><a href="/mypage.html"
                        class="flex items-center justify-center rounded-full px-4 py-2 text-[14px] md:text-[15px] font-bold text-white bg-primary-orange shadow-md hover:bg-[#e06d2e] transition-all">My
                        Page</a></li>
                <li><a href="/about.html"
                        class="flex items-center justify-center rounded-full px-4 py-2 text-[14px] md:text-[15px] font-bold text-white bg-primary-beige shadow-md hover:bg-[#c49f5b] transition-all">About</a>
                </li>
            </ul>
        </div>
    </nav>

    <main class="max-w-[1200px] mx-auto px-5 py-10">
        <header class="text-center mb-16">
            <h1 class="text-3xl md:text-5xl font-extrabold text-gray-900 mb-4 tracking-tight">ì •ì±… ì¹´ë“œ ì»¬ë ‰ì…˜ âœ¨</h1>
            <p class="text-gray-500 text-lg mb-5">ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë ¤ë³´ì„¸ìš”! í™”ë©´ í¬ê¸°ì— ë§ì¶° ì¹´ë“œê°€ ë°˜ì‘í•©ë‹ˆë‹¤.</p>

            <div class="max-w-2xl mx-auto mb-6">
                <div
                    class="relative flex items-center w-full h-14 rounded-full focus-within:shadow-lg bg-white overflow-hidden border border-gray-200 shadow-sm transition-shadow duration-300">
                    <div class="grid place-items-center h-full w-12 text-gray-400">
                        <i class="fa-solid fa-magnifying-glass text-lg"></i>
                    </div>
                    <input class="peer h-full w-full outline-none pr-12 text-base bg-transparent placeholder-gray-400"
                        style="color: #1f2937;" type="text" id="search-input"
                        placeholder="í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ë³´ì„¸ìš” (ì˜ˆ: ì²­ë…„, ì›”ì„¸, ì·¨ì—…)" />

                    <button id="clear-btn"
                        class="hidden absolute right-4 text-gray-400 hover:text-gray-600 focus:outline-none transition-colors">
                        <i class="fa-solid fa-circle-xmark text-xl"></i>
                    </button>
                </div>
            </div>

            <div class="relative w-full max-w-[800px] mx-auto group px-8 sm:px-0">
                <button id="scroll-left"
                    class="absolute left-0 top-1/2 -translate-y-1/2 z-10 w-8 h-8 rounded-full bg-black/20 text-white backdrop-blur-sm flex items-center justify-center opacity-0 pointer-events-none transition-opacity duration-300 hover:bg-black/40 sm:hidden">
                    <i class="fa-solid fa-chevron-left"></i>
                </button>

                <div id="category-filters"
                    class="flex gap-2 overflow-x-auto pb-2 sm:justify-center justify-start hide-scrollbar scroll-smooth snap-x">

                    <button
                        class="filter-btn active snap-center shrink-0 px-5 py-2.5 rounded-full bg-[#777777] text-white text-sm font-bold transition-all shadow-md hover:bg-[#555555] hover:text-white flex items-center gap-2"
                        data-category="all">
                        <i class="fa-solid fa-layer-group"></i> ì „ì²´
                    </button>

                    <button
                        class="filter-btn snap-center shrink-0 px-5 py-2.5 rounded-full bg-white border border-gray-200 text-gray-600 text-sm font-bold hover:bg-teal-50 hover:text-primary-teal hover:border-primary-teal transition-all flex items-center gap-2"
                        data-category="ì·¨ì—…">
                        <i class="fa-solid fa-briefcase"></i> ì·¨ì—…
                    </button>

                    <button
                        class="filter-btn snap-center shrink-0 px-5 py-2.5 rounded-full bg-white border border-gray-200 text-gray-600 text-sm font-bold hover:bg-orange-50 hover:text-primary-orange hover:border-primary-orange transition-all flex items-center gap-2"
                        data-category="ì£¼ê±°">
                        <i class="fa-solid fa-house-chimney"></i> ì£¼ê±°
                    </button>

                    <button
                        class="filter-btn snap-center shrink-0 px-5 py-2.5 rounded-full bg-white border border-gray-200 text-gray-600 text-sm font-bold hover:bg-yellow-50 hover:text-primary-beige hover:border-primary-beige transition-all flex items-center gap-2"
                        data-category="ê¸ˆìœµ">
                        <i class="fa-solid fa-coins"></i> ê¸ˆìœµ
                    </button>

                    <button
                        class="filter-btn snap-center shrink-0 px-5 py-2.5 rounded-full bg-white border border-gray-200 text-gray-600 text-sm font-bold hover:bg-red-50 hover:text-[#FF5A5F] hover:border-[#FF5A5F] transition-all flex items-center gap-2"
                        data-category="ì°½ì—…">
                        <i class="fa-solid fa-rocket"></i> ì°½ì—…
                    </button>

                    <button
                        class="filter-btn snap-center shrink-0 px-5 py-2.5 rounded-full bg-white border border-gray-200 text-gray-600 text-sm font-bold hover:bg-purple-50 hover:text-purple-500 hover:border-purple-500 transition-all flex items-center gap-2"
                        data-category="ë³µì§€">
                        <i class="fa-solid fa-hand-holding-heart"></i> ë³µì§€
                    </button>

                    <button
                        class="filter-btn snap-center shrink-0 px-5 py-2.5 rounded-full bg-white border border-gray-200 text-gray-600 text-sm font-bold hover:bg-blue-50 hover:text-blue-500 hover:border-blue-500 transition-all flex items-center gap-2"
                        data-category="êµìœ¡">
                        <i class="fa-solid fa-graduation-cap"></i> êµìœ¡
                    </button>
                </div>

                <button id="scroll-right"
                    class="absolute right-0 top-1/2 -translate-y-1/2 z-10 w-8 h-8 rounded-full bg-black/20 text-white backdrop-blur-sm flex items-center justify-center sm:hidden hover:bg-black/40 transition-colors">
                    <i class="fa-solid fa-chevron-right"></i>
                </button>
            </div>
        </header>

        <div id="card-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 pb-10">
        </div>
        <div id="loading-indicator" class="hidden w-full flex justify-center items-center py-10">
            <div class="animate-spin rounded-full h-10 w-10 border-t-4 border-b-4 border-primary-teal"></div>
        </div>

        <div id="pagination-container" class="flex justify-center flex-wrap gap-2 py-8 mt-4">
        </div>

        <div id="no-result" class="hidden text-center py-20">
            <div class="text-6xl mb-4 grayscale opacity-50">ğŸ¤”</div>
            <h3 class="text-xl font-bold text-gray-700 mb-2">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ì–´ìš”.</h3>
            <p class="text-gray-500">ë‹¤ë¥¸ í‚¤ì›Œë“œë¡œ ê²€ìƒ‰í•˜ê±°ë‚˜ í•„í„°ë¥¼ 'ì „ì²´'ë¡œ ë³€ê²½í•´ë³´ì„¸ìš”.</p>
        </div>
    </main>

    <script>
        // --- 1. ì„¤ì • ë° ìœ í‹¸ë¦¬í‹° ---
        // [ìœ í‹¸ë¦¬í‹°] ë””ë°”ìš´ìŠ¤ í•¨ìˆ˜: ì—°ì†ëœ ì´ë²¤íŠ¸ë¥¼ ì œì–´í•˜ì—¬ ì„±ëŠ¥ ìµœì í™”
        const ITEMS_PER_PAGE = 8; // í•œ í˜ì´ì§€ë‹¹ ë³´ì—¬ì¤„ ì¹´ë“œ ê°œìˆ˜
        let currentPage = 1;      // í˜„ì¬ í˜ì´ì§€ ë²ˆí˜¸

        const debounce = (func, delay) => {
            let timeoutId;
            return (...args) => {
                clearTimeout(timeoutId);
                timeoutId = setTimeout(() => func(...args), delay);
            };
        };

        // 2. ë°ì´í„° ë° ì´ë¯¸ì§€ ì„¤ì •
        const categoryMap = { "ì£¼ê±°": "housing", "ì·¨ì—…": "job", "ê¸ˆìœµ": "finance", "ë³µì§€": "welfare", "ì°½ì—…": "startup", "êµìœ¡": "growth" };

        // [ìˆ˜ì •ëœ ë°ì´í„°] JS ì½”ë“œ ë‚´ baseDataë¥¼ ì´ê²ƒìœ¼ë¡œ êµì²´í•˜ì„¸ìš”.
        const baseData = [
            { id: 1, title: "ì²­ë…„ ì•ˆì‹¬ ì£¼íƒ", category: "ì£¼ê±°", desc: "ì—­ì„¸ê¶Œ ì²­ë…„ ì£¼íƒ ì…ì£¼ì ëª¨ì§‘ ê³µê³ ", colorCode: "#F48245" },
            { id: 2, title: "ì·¨ì—… ì‚¬ê´€í•™êµ", category: "ì·¨ì—…", desc: "SW ê°œë°œì ë°ë·” ê³¼ì • ë¬´ë£Œ êµìœ¡ìƒ ëª¨ì§‘", colorCode: "#4A9EA8" },
            { id: 3, title: "í•™ìê¸ˆ ëŒ€ì¶œ ì´ì", category: "ê¸ˆìœµ", desc: "í•™ìê¸ˆ ëŒ€ì¶œ ì´ì ì „ì•¡ ì§€ì›", colorCode: "#D9B36C" },
            { id: 4, title: "ë§ˆìŒ ê±´ê°• ìƒë‹´ì†Œ", category: "ë³µì§€", desc: "ì „ë¬¸ ì‹¬ë¦¬ ìƒë‹´ì‚¬ì™€ 1:1 ë¬´ë£Œ ìƒë‹´", colorCode: "#9F7AEA" },
            { id: 5, title: "ì „ì„¸ ë³´ì¦ê¸ˆ ë°˜í™˜", category: "ì£¼ê±°", desc: "ì „ì„¸ ì‚¬ê¸° ê±±ì • ì—†ëŠ” ë³´ì¦ë£Œ ì§€ì›", colorCode: "#F48245" },
            { id: 6, title: "ë¯¸ë˜ ì²­ë…„ ì¼ìë¦¬", category: "ì·¨ì—…", desc: "ì‹ ì‚°ì—… ë¶„ì•¼ ê¸°ì—… ë§¤ì¹­ ë° ì¸ê±´ë¹„ ì§€ì›", colorCode: "#4A9EA8" },
            { id: 7, title: "ë¬¸í™” ì˜ˆìˆ  íŒ¨ìŠ¤", category: "ë³µì§€", desc: "ê³µì—°, ì „ì‹œ ê´€ëŒë¹„ 10ë§Œì› ì§€ì›", colorCode: "#9F7AEA" },
            { id: 8, title: "ì²­ë…„ ëŒ€ì¤‘êµí†µë¹„", category: "ê¸ˆìœµ", desc: "ëŒ€ì¤‘êµí†µ ì´ìš©ìš”ê¸ˆ ì¼ë¶€ í™˜ê¸‰", colorCode: "#D9B36C" },
            { id: 9, title: "ì°½ì—… ëŸ°ì›¨ì´", category: "ì°½ì—…", desc: "ìŠ¤íƒ€íŠ¸ì—… ì´ˆê¸° ìê¸ˆ ì§€ì› ë° ë©˜í† ë§", colorCode: "#FF5A5F" },
            { id: 10, title: "ê¸€ë¡œë²Œ ì¸ì¬ ì–‘ì„±", category: "êµìœ¡", desc: "í•´ì™¸ ì—°ìˆ˜ ë° ì–´í•™ í”„ë¡œê·¸ë¨ ì§€ì›", colorCode: "#4299E1" },
            { id: 11, title: "ì²­ë…„ ì €ì¶• ê³„ì¢Œ", category: "ê¸ˆìœµ", desc: "ë§¤ì›” 10ë§Œì› ì €ì¶• ì‹œ ì •ë¶€ ì§€ì›ê¸ˆ ë§¤ì¹­", colorCode: "#D9B36C" },
            { id: 12, title: "1ì¸ ê°€êµ¬ ë³‘ì› ë™í–‰", category: "ë³µì§€", desc: "ì•„í”Œ ë•Œ ë³‘ì›ê¹Œì§€ ë§¤ë‹ˆì € ë™í–‰ ì„œë¹„ìŠ¤", colorCode: "#9F7AEA" },
            { id: 13, title: "ì²­ë…„ ë†ë¶€ ì§€ì›", category: "ì°½ì—…", desc: "ê·€ë† ê·€ì´Œ ì •ì°©ê¸ˆ ë° ë†ì§€ ì„ëŒ€ ì§€ì›", colorCode: "#FF5A5F" },
            { id: 14, title: "ë””ì§€í„¸ ë°°ì›€í„°", category: "êµìœ¡", desc: "ì „ êµ­ë¯¼ ë””ì§€í„¸ ì—­ëŸ‰ ê°•í™” ë¬´ë£Œ êµìœ¡", colorCode: "#4299E1" },
            { id: 15, title: "í–‰ë³µ ê¸°ìˆ™ì‚¬", category: "ì£¼ê±°", desc: "ëŒ€í•™ìƒ ì—°í•© ê¸°ìˆ™ì‚¬ ì…ì£¼ ì‹ ì²­", colorCode: "#F48245" }
        ];

        // [í•µì‹¬ ë¡œì§] ì¹´í…Œê³ ë¦¬ë³„ë¡œ ì´ë¯¸ì§€ ë²ˆí˜¸ë¥¼ ìˆœì„œëŒ€ë¡œ ë¶€ì—¬í•˜ê¸° ìœ„í•œ ì¹´ìš´í„°
        const categoryCounters = {};

        // ì´ë¯¸ì§€ ê²½ë¡œ ë§¤í•‘
        const policyData = baseData.map(item => {
            const prefix = categoryMap[item.category] || "welfare";

            // 1. í˜„ì¬ ì¹´í…Œê³ ë¦¬ì˜ ì¹´ìš´í„°ê°€ ì—†ìœ¼ë©´ 0ìœ¼ë¡œ ì´ˆê¸°í™”
            if (categoryCounters[item.category] === undefined) {
                categoryCounters[item.category] = 0;
            }

            // 2. í˜„ì¬ ì¹´ìš´í„° ìˆ«ìë¥¼ ê°€ì ¸ì™€ì„œ ì´ë¯¸ì§€ ë²ˆí˜¸ ê²°ì • (1~5 ìˆœí™˜)
            const count = categoryCounters[item.category];
            const imgIndex = (count % 5) + 1;

            // 3. ë‹¤ìŒì„ ìœ„í•´ ì¹´ìš´í„° ì¦ê°€
            categoryCounters[item.category]++;

            item.img = `/static/images/card_images/${prefix}_${imgIndex}.webp`;
            return item;
        });

        // --- 3. 3D íš¨ê³¼ í•¨ìˆ˜ (ì™„ì „ ë¶„ë¦¬ êµ¬ì¡°) ---
        function init3DEffect() {
            // ëª¨ë°”ì¼ì—ì„œëŠ” 3D íš¨ê³¼ ë„ê¸° (ì„±ëŠ¥ ì´ìŠˆ ë°©ì§€)
            if (window.innerWidth < 768) return;
            const wrappers = document.querySelectorAll('.perspective-wrap');

            wrappers.forEach(wrapper => {
                // ì´ë¯¸ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ ë¶™ì–´ìˆëŠ”ì§€ í™•ì¸ (ì¤‘ë³µ ë°©ì§€)
                if (wrapper.dataset.gsapInitialized) return;
                wrapper.dataset.gsapInitialized = "true";

                // [í•µì‹¬ ë¶„ë¦¬]
                // lifter: ìœ„ì•„ë˜ ì›€ì§ì„ ë‹´ë‹¹
                // card: íšŒì „ ë‹´ë‹¹
                const lifter = wrapper.querySelector('.card-lifter');
                const card = wrapper.querySelector('.policy-card');
                const cardImage = wrapper.querySelector('.card-image img');
                const borderColor = card.dataset.color;

                // [Enter]: ë¦¬í”„í„°(lifter)ë§Œ ì›€ì§ì„
                wrapper.addEventListener('mouseenter', () => {
                    gsap.set(wrapper, { zIndex: 50 });
                    gsap.to(lifter, { y: -12, scale: 1.05, duration: 0.4, ease: "back.out(1.4)", overwrite: "auto" });
                    gsap.to(card, { borderColor: borderColor, boxShadow: "0 20px 40px -5px rgba(0,0,0,0.2)", duration: 0.3 });
                });

                // [Move]: ì¹´ë“œ(card)ë§Œ íšŒì „ì‹œí‚´ (ë¦¬í”„í„°ëŠ” ê±´ë“œë¦¬ì§€ ì•ŠìŒ -> ì¶©ëŒ ì›ì²œ ë´‰ì‡„)
                wrapper.addEventListener('mousemove', (e) => {
                    const rect = wrapper.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    const centerX = rect.width / 2;
                    const centerY = rect.height / 2;
                    const rotateX = ((y - centerY) / centerY) * -5;
                    const rotateY = ((x - centerX) / centerX) * 5;

                    gsap.to(card, { rotateX: rotateX, rotateY: rotateY, duration: 0.1, ease: "power1.out", overwrite: "auto" });
                    // [ìˆ˜ì •] ë°˜ì‘ ì†ë„ë¥¼ ëŠë¦¬ê²Œ (0.5 -> 1.0)
                    if (cardImage) gsap.to(cardImage, { x: (x - centerX) * 0.05, y: (y - centerY) * 0.05, duration: 1.0, ease: "power2.out" });
                });

                // [Leave]: ë‘˜ ë‹¤ ì›ìƒë³µêµ¬
                wrapper.addEventListener('mouseleave', () => {
                    gsap.delayedCall(0.3, () => gsap.set(wrapper, { zIndex: 1 }));
                    // ë¦¬í”„í„° ë³µêµ¬
                    gsap.to(lifter, { y: 0, scale: 1, duration: 1.0, ease: "power3.out" });
                    // ì¹´ë“œ ë³µêµ¬ (ë¹ ë¥´ê²Œ)
                    gsap.to(card, { rotateX: 0, rotateY: 0, borderColor: '#e5e7eb', boxShadow: "0 1px 2px 0 rgba(0, 0, 0, 0.05)", duration: 0.3, ease: "power3.out" });
                    if (cardImage) gsap.to(cardImage, { x: 0, y: 0, duration: 0.3 });
                });
            });
        }

        // [ë³„ë„ í•¨ìˆ˜] ë“±ì¥ ì• ë‹ˆë©”ì´ì…˜ (ì¶©ëŒ ë°©ì§€ë¥¼ ìœ„í•´ ë¶„ë¦¬)
        function playEntranceAnimation() {
            gsap.from(".card-lifter", {
                y: 50, opacity: 0, duration: 0.6, stagger: 0.05, ease: "power2.out", clearProps: "all"
            });
        }

        // --- 4. í˜ì´ì§€ë„¤ì´ì…˜ ë Œë”ë§ í•¨ìˆ˜ ---
        function renderPagination(totalItems) {
            const paginationContainer = document.getElementById('pagination-container');
            paginationContainer.innerHTML = ""; // ê¸°ì¡´ ë²„íŠ¼ ì´ˆê¸°í™”

            const totalPages = Math.ceil(totalItems / ITEMS_PER_PAGE);

            // í˜ì´ì§€ê°€ 1ê°œ ì´í•˜ê±°ë‚˜ ì—†ìœ¼ë©´ ë²„íŠ¼ ìˆ¨ê¹€
            if (totalPages <= 1) return;

            // í˜ì´ì§€ ë²ˆí˜¸ ë²„íŠ¼ ìƒì„± (1ë¶€í„° totalPagesê¹Œì§€)
            for (let i = 1; i <= totalPages; i++) {
                const btn = document.createElement('button');
                btn.innerText = i;
                let baseClass = "w-10 h-10 rounded-full text-sm font-bold transition-all flex items-center justify-center border";

                // í˜„ì¬ í˜ì´ì§€(Active) vs ë‹¤ë¥¸ í˜ì´ì§€ ë””ìì¸ ë¶„ê¸°
                if (i === currentPage) {
                    // [ìˆ˜ì • í›„] bg-[#777777] border-[#777777] (ì „ì²´ ë²„íŠ¼ ìƒ‰ìƒê³¼ í†µì¼)
                    btn.className = `${baseClass} bg-[#777777] text-white border-[#777777] shadow-md transform scale-105`;
                } else {
                    btn.className = `${baseClass} bg-white text-gray-500 border-gray-200 hover:bg-gray-100 hover:text-primary-teal`;
                }

                btn.addEventListener('click', () => {
                    currentPage = i; // í˜ì´ì§€ ë³€ê²½
                    const currentBtn = document.querySelector('.filter-btn.active');
                    const currentCategory = currentBtn ? currentBtn.dataset.category : 'all';
                    const keyword = document.getElementById('search-input').value;
                    renderCards(currentCategory, keyword, true); // ë Œë”ë§ ì‹¤í–‰ (ìŠ¤í¬ë¡¤ ì´ë™ í¬í•¨)
                });
                paginationContainer.appendChild(btn);
            }
        }

        // --- 5. ì¹´ë“œ ë Œë”ë§ í•¨ìˆ˜ ---
        function renderCards(filterCategory = "all", keyword = "", isPageChange = false) {
            const container = document.getElementById('card-container');
            const noResult = document.getElementById('no-result');

            // 1. ì „ì²´ ë°ì´í„° í•„í„°ë§
            const filteredData = policyData.filter(item => {
                const matchCategory = filterCategory === "all" || item.category === filterCategory;
                const matchKeyword = item.title.includes(keyword) || item.desc.includes(keyword) || item.category.includes(keyword);
                return matchCategory && matchKeyword;
            });

            // 2. ê²€ìƒ‰/í•„í„° ë³€ê²½ ì‹œ í˜ì´ì§€ë¥¼ 1ë¡œ ì´ˆê¸°í™” (í˜ì´ì§€ ì´ë™ì´ ì•„ë‹ ê²½ìš°)
            if (!isPageChange) currentPage = 1;

            // 3. í˜ì´ì§€ë„¤ì´ì…˜ ê³„ì‚° (Slice)
            const startIndex = (currentPage - 1) * ITEMS_PER_PAGE;
            const endIndex = startIndex + ITEMS_PER_PAGE;
            const visibleData = filteredData.slice(startIndex, endIndex);

            // 4. ê²°ê³¼ ì—†ìŒ ì²˜ë¦¬
            if (filteredData.length === 0) {
                container.innerHTML = "";
                document.getElementById('pagination-container').innerHTML = ""; // ë²„íŠ¼ë„ ì‚­ì œ
                if (noResult) noResult.classList.remove('hidden');
                return;
            }
            if (noResult) noResult.classList.add('hidden');

            // [í•µì‹¬] .perspective-wrap > .card-lifter > .policy-card êµ¬ì¡° ìƒì„±
            container.innerHTML = visibleData.map(item => {
                const itemJson = encodeURIComponent(JSON.stringify(item));
                return `
                <div class="perspective-wrap h-full cursor-pointer group" onclick="openCardModal(this)" data-json="${itemJson}" style="z-index: 1;">
                    <div class="card-lifter">
                        <div class="policy-card relative bg-white rounded-xl overflow-hidden h-full flex flex-col border border-gray-100 shadow-sm transition-colors"
                             data-color="${item.colorCode}">
                            <div class="card-image w-full bg-white flex items-end justify-center shrink-0 h-[200px] overflow-hidden relative">
                                <img src="${item.img}" alt="${item.title}" class="w-full h-full object-cover" onerror="this.src='/static/images/card_images/default.png'">
                            </div>
                            <div class="card-content text-left bg-white flex-grow flex flex-col justify-between p-5 z-20 relative">
                                <div>
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="text-xs font-bold text-primary-orange bg-orange-100 px-2 py-0.5 rounded">#${item.category}</span>
                                    </div>
                                    <h3 class="card-title mb-2 line-clamp-1 text-xl font-extrabold text-[#222] group-hover:text-primary-teal transition-colors">${item.title}</h3>
                                    <p class="card-desc line-clamp-2 text-sm text-[#666] font-medium leading-relaxed">${item.desc}</p>
                                </div>
                                <div class="card-date flex justify-between items-center mt-4 text-xs text-[#888] border-t pt-3 border-gray-100">
                                    <span>2025.12.31 ë§ˆê°</span>
                                    <i class="fa-solid fa-arrow-right text-gray-300 group-hover:text-primary-teal transition-transform group-hover:translate-x-1"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`;
            }).join('');

            renderPagination(filteredData.length);
            init3DEffect(); // [í•µì‹¬] ë Œë”ë§ ì§í›„ GSAP ê¸°ëŠ¥ ì—°ê²°

            // 8. í˜ì´ì§€ ì´ë™ ì‹œ ìŠ¤í¬ë¡¤ì„ ë§¨ ìœ„ë¡œ (UX)
            if (isPageChange) {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
            playEntranceAnimation();
        }

        // --- DOMContentLoaded: ëª¨ë“  ë¡œì§ì„ ì´ê³³ì— ëª¨ìŒ (í•µì‹¬) ---
        document.addEventListener('DOMContentLoaded', () => {
            // ì´ˆê¸° ë Œë”ë§
            renderCards("all", "", false);

            // UI ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
            const searchInput = document.getElementById('search-input');
            const clearBtn = document.getElementById('clear-btn');
            const filterBtns = document.querySelectorAll('.filter-btn');

            // --- [NEW] ê²€ìƒ‰ ì´ˆê¸°í™” ë²„íŠ¼ ë¡œì§ ---
            if (searchInput && clearBtn) {
                const toggleClearBtn = () => {
                    if (searchInput.value.length > 0) clearBtn.classList.remove('hidden');
                    else clearBtn.classList.add('hidden');
                };
                searchInput.addEventListener('input', toggleClearBtn);
                clearBtn.addEventListener('click', () => {
                    searchInput.value = '';
                    toggleClearBtn();
                    searchInput.focus();
                    const currentBtn = document.querySelector('.filter-btn.active');
                    const currentCategory = currentBtn ? currentBtn.dataset.category : 'all';
                    renderCards(currentCategory, '', false);
                });
            }

            // [ìˆ˜ì •] ê²€ìƒ‰ ê¸°ëŠ¥ì— ë””ë°”ìš´ìŠ¤(Debounce) ì ìš© (300ms ë”œë ˆì´)
            if (searchInput) {
                searchInput.addEventListener('input', debounce((e) => {
                    const currentBtn = document.querySelector('.filter-btn.active');
                    const currentCategory = currentBtn ? currentBtn.dataset.category : 'all';
                    renderCards(currentCategory, e.target.value, false);
                }, 300));
            }

            // í•„í„° ë²„íŠ¼ ì´ë²¤íŠ¸ ì—°ê²°
            filterBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    filterBtns.forEach(b => {
                        b.classList.remove('bg-[#777777]', 'text-white');
                        b.classList.add('bg-white', 'text-gray-600', 'border');
                    });
                    btn.classList.remove('bg-white', 'text-gray-600', 'border');
                    btn.classList.add('bg-[#777777]', 'text-white', 'active');

                    const keyword = searchInput ? searchInput.value : "";
                    renderCards(btn.dataset.category, keyword, false);
                });
            });

            // --- [NEW] ì¹´í…Œê³ ë¦¬ ìºëŸ¬ì…€ ë¡œì§ (í™”ì‚´í‘œ ì œì–´) ---
            const filterContainer = document.getElementById('category-filters');
            const leftBtn = document.getElementById('scroll-left');
            const rightBtn = document.getElementById('scroll-right');

            if (filterContainer && leftBtn && rightBtn) {
                const updateArrows = () => {
                    const scrollLeft = filterContainer.scrollLeft;
                    const maxScroll = filterContainer.scrollWidth - filterContainer.clientWidth;
                    if (scrollLeft > 10) leftBtn.classList.remove('opacity-0', 'pointer-events-none');
                    else leftBtn.classList.add('opacity-0', 'pointer-events-none');

                    if (scrollLeft < maxScroll - 10) rightBtn.classList.remove('opacity-0', 'pointer-events-none');
                    else rightBtn.classList.add('opacity-0', 'pointer-events-none');
                };

                leftBtn.addEventListener('click', () => filterContainer.scrollBy({ left: -200, behavior: 'smooth' }));
                rightBtn.addEventListener('click', () => filterContainer.scrollBy({ left: 200, behavior: 'smooth' }));
                filterContainer.addEventListener('scroll', debounce(updateArrows, 50));

                updateArrows();
                window.addEventListener('resize', updateArrows);

                // [ì¶”ê°€] ëª¨ë°”ì¼ ë²„íŠ¼ í´ë¦­ ì‹œ ìë™ ìŠ¤í¬ë¡¤
                filterBtns.forEach(btn => {
                    btn.addEventListener('click', function () {
                        if (window.innerWidth < 640) {
                            const containerRect = filterContainer.getBoundingClientRect();
                            const btnRect = this.getBoundingClientRect();
                            const offset = btnRect.left - containerRect.left - (containerRect.width / 2) + (btnRect.width / 2);
                            filterContainer.scrollBy({ left: offset, behavior: 'smooth' });
                        }
                    });
                });
            }

            // 1. í–„ë²„ê±° ë©”ë‰´ ë° Nav ë¡œì§ (ìœ ì§€)
            const hamburgerBtn = document.getElementById('hamburger-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            if (hamburgerBtn && mobileMenu) {
                hamburgerBtn.addEventListener('click', () => {
                    mobileMenu.classList.toggle('hidden');
                    if (!mobileMenu.classList.contains('hidden')) {
                        gsap.fromTo(mobileMenu, { opacity: 0, y: -20 }, { opacity: 1, y: 0, duration: 0.3 });
                    }
                });
            }
        });

        // [í˜‘ì—…ìš©] ëª¨ë‹¬ ê¸°ëŠ¥ ì˜¤ë¥˜ ì—†ë„ë¡ ê»ë°ê¸°ë§Œ êµ¬í˜„ í•´ë‘” ìƒíƒœ
        function openCardModal(element) {
            console.log("ëª¨ë‹¬ ì—´ê¸°:", element.dataset.json);
        }
    </script>
</body>

</html>